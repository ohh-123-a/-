# ğŸŒ 007 ç½‘ç»œç®¡ç†

------

## 1ï¸âƒ£ ğŸŒ ç½‘ç»œé…ç½®

### ğŸ§­ æŸ¥çœ‹ç½‘ç»œä¿¡æ¯

```bash
ifconfig              # æ—§å‘½ä»¤ï¼ˆéœ€å®‰è£… net-toolsï¼‰
ip addr               # æ–°æ¨èå‘½ä»¤
ip link show          # æŸ¥çœ‹ç½‘ç»œæ¥å£
ip route show         # æŸ¥çœ‹è·¯ç”±è¡¨
```

è¾“å‡ºç¤ºä¾‹ï¼š

```bash
2: ens33: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc fq_codel state UP
    inet 192.168.1.100/24 brd 192.168.1.255 scope global dynamic ens33
```

ğŸ“˜ **å‘½ä»¤å¯¹æ¯”ï¼š**

| å‘½ä»¤       | åŠŸèƒ½               | æ¨èåº¦   |
| ---------- | ------------------ | -------- |
| `ifconfig` | æŸ¥çœ‹IPã€MACã€çŠ¶æ€  | ğŸŸ¡ æ—§å·¥å…· |
| `ip addr`  | æŸ¥çœ‹ä¸é…ç½®IPåœ°å€   | ğŸŸ¢ æ¨è   |
| `ip route` | æŸ¥çœ‹è·¯ç”±ä¸ç½‘å…³é…ç½® | ğŸŸ¢ æ¨è   |

------

### âš™ï¸ IP é…ç½®æ–¹å¼

#### ï¼ˆ1ï¼‰ä¸´æ—¶é…ç½®ï¼ˆé‡å¯å¤±æ•ˆï¼‰

```bash
sudo ip addr add 192.168.1.100/24 dev eth0
sudo ip route add default via 192.168.1.1
```

æŸ¥çœ‹ç»“æœï¼š

```bash
ip addr show dev eth0
```

#### ï¼ˆ2ï¼‰æ°¸ä¹…é…ç½®

##### ğŸ–¥ CentOS / RHELï¼š

ç¼–è¾‘ç½‘å¡é…ç½®ï¼š

```bash
sudo vim /etc/sysconfig/network-scripts/ifcfg-eth0
```

å†…å®¹ç¤ºä¾‹ï¼š

```bash
TYPE=Ethernet
BOOTPROTO=static
NAME=eth0
DEVICE=eth0
ONBOOT=yes
IPADDR=192.168.1.100
NETMASK=255.255.255.0
GATEWAY=192.168.1.1
DNS1=8.8.8.8
```

é‡å¯ç½‘ç»œï¼š

```bash
systemctl restart network
```

##### ğŸ§© Ubuntu / Debianï¼š

```bash
sudo vim /etc/netplan/01-netcfg.yaml
```

ç¤ºä¾‹ï¼š

```bash
network:
  version: 2
  ethernets:
    eth0:
      dhcp4: no
      addresses: [192.168.1.100/24]
      gateway4: 192.168.1.1
      nameservers:
        addresses: [8.8.8.8, 114.114.114.114]
```

åº”ç”¨ï¼š

```bash
sudo netplan apply
```

#### ï¼ˆ3ï¼‰å›¾å½¢åŒ–é…ç½®ï¼ˆé€‚åˆæ–°æ‰‹ï¼‰

```bash
nmtui     # NetworkManager äº¤äº’ç•Œé¢å·¥å…·
nm-connection-editor
```

------

## 2ï¸âƒ£ ğŸ§­ ç½‘ç»œè¯Šæ–­ä¸æ’éšœ

å½“å‡ºç° â€œç½‘ç»œä¸é€šâ€ æ—¶ï¼Œå¯æŒ‰ä»¥ä¸‹é€»è¾‘æ’æŸ¥ğŸ‘‡

| æ­¥éª¤ | æ£€æŸ¥å†…å®¹       | å‘½ä»¤                      |
| ---- | -------------- | ------------------------- |
| â‘     | æ˜¯å¦æœ‰IPåœ°å€   | `ip addr`                 |
| â‘¡    | èƒ½å¦Pingæœ¬æœº   | `ping 127.0.0.1`          |
| â‘¢    | ç½‘å…³æ˜¯å¦å¯è¾¾   | `ping 192.168.1.1`        |
| â‘£    | DNSæ˜¯å¦å·¥ä½œ    | `nslookup www.baidu.com`  |
| â‘¤    | è·¯ç”±æ˜¯å¦æ­£ç¡®   | `ip route`                |
| â‘¥    | æ˜¯å¦é˜²ç«å¢™é˜»æ–­ | `firewall-cmd --list-all` |

ç¤ºä¾‹å‘½ä»¤ï¼š

```bash
ping www.baidu.com
traceroute www.google.com
mtr www.baidu.com          # è¿ç»­è¿½è¸ªè·¯ç”±
```

### ğŸ” æŸ¥çœ‹ç«¯å£ä¸è¿æ¥

```bash
ss -tuln                   # æŸ¥çœ‹ç›‘å¬ç«¯å£ï¼ˆæ¨èï¼‰
netstat -tuln              # æ—§å‘½ä»¤
lsof -i :80                # æŸ¥çœ‹80ç«¯å£å ç”¨è¿›ç¨‹
```

ğŸ“˜ **å‚æ•°è¯´æ˜ï¼š**

| å‚æ•° | å«ä¹‰                |
| ---- | ------------------- |
| `-t` | TCP                 |
| `-u` | UDP                 |
| `-l` | Listeningï¼ˆç›‘å¬ä¸­ï¼‰ |
| `-n` | ä¸è§£æåŸŸå          |

------

## 3ï¸âƒ£ ğŸ”’ ç½‘ç»œæœåŠ¡ä¸è¿œç¨‹ç®¡ç†

### DNS é…ç½®

```bash
cat /etc/resolv.conf
```

ç¤ºä¾‹ï¼š

```bash
nameserver 8.8.8.8
nameserver 114.114.114.114
```

### SSH æœåŠ¡

```bash
ssh user@hostname           # è¿œç¨‹è¿æ¥
scp file user@host:/tmp/    # æ–‡ä»¶ä¼ è¾“
ssh-keygen -t rsa           # ç”Ÿæˆå¯†é’¥å¯¹
ssh-copy-id user@host       # åˆ†å‘å…¬é’¥
```

æŸ¥çœ‹ SSH æœåŠ¡çŠ¶æ€ï¼š

```bash
systemctl status sshd
```

------

## 4ï¸âƒ£ ğŸ”¥ é˜²ç«å¢™ä¸ç«¯å£ç®¡ç†

### Firewalldï¼ˆCentOSï¼‰

```bash
systemctl status firewalld
firewall-cmd --list-all
firewall-cmd --add-port=8080/tcp --permanent
firewall-cmd --reload
```

### UFWï¼ˆUbuntuï¼‰

```bash
sudo ufw status
sudo ufw allow 22/tcp
sudo ufw enable
```

------

## 5ï¸âƒ£ ğŸ“¡ æŠ“åŒ…ä¸æµé‡åˆ†æ

### tcpdump æŠ“åŒ…

```bash
tcpdump -i eth0 -n host 192.168.1.1
tcpdump -i eth0 port 80 -c 10
tcpdump -w capture.pcap
```

ğŸ“˜ å¸¸ç”¨å‚æ•°ï¼š

| å‚æ•° | è¯´æ˜         |
| ---- | ------------ |
| `-i` | æŒ‡å®šç½‘å¡æ¥å£ |
| `-n` | ä¸è§£æä¸»æœºå |
| `-c` | æŠ“å–æŒ‡å®šæ•°é‡ |
| `-w` | ä¿å­˜åˆ°æ–‡ä»¶   |

å¯ç”¨ Wireshark æ‰“å¼€ `capture.pcap` æ–‡ä»¶åˆ†æã€‚

------

## 6ï¸âƒ£ âš™ï¸ ç½‘ç»œæ€§èƒ½ä¼˜åŒ–

### è°ƒæ•´ MTU

```bash
ip link set eth0 mtu 1400
```

### ä¼˜åŒ–å†…æ ¸å‚æ•°ï¼ˆç½‘ç»œååï¼‰

```bash
sudo vim /etc/sysctl.conf
```

æ·»åŠ ï¼š

```bash
net.core.somaxconn = 1024
net.ipv4.tcp_fin_timeout = 30
net.ipv4.tcp_tw_reuse = 1
```

åº”ç”¨é…ç½®ï¼š

```bash
sysctl -p
```

### æµ‹è¯•å¸¦å®½ä¸å»¶è¿Ÿ

```bash
iperf3 -s                 # æœåŠ¡å™¨ç«¯
iperf3 -c 192.168.1.1     # å®¢æˆ·ç«¯æµ‹è¯•
```

------

## 7ï¸âƒ£ ğŸŒ‰ ç½‘ç»œæ¨¡å¼è¯¦è§£ï¼ˆBridge / NAT / Host-onlyï¼‰

åœ¨è™šæ‹ŸåŒ–ç¯å¢ƒï¼ˆå¦‚ VMwareã€VirtualBoxã€KVMï¼‰ä¸­ï¼ŒLinux ç½‘ç»œæ¨¡å¼å†³å®šäº†è™šæ‹Ÿæœºä¸ä¸»æœºã€å¤–ç½‘ä¹‹é—´çš„é€šä¿¡æ–¹å¼ã€‚

ä¸‹é¢æˆ‘ä»¬é‡ç‚¹è®²è§£ä¸‰ç§æœ€å¸¸è§æ¨¡å¼ğŸ‘‡

------

### ğŸ§© â‘  æ¡¥æ¥æ¨¡å¼ï¼ˆBridged Adapterï¼‰

ğŸ“˜ **åŸç†ï¼š**
 è™šæ‹Ÿæœºçš„ç½‘å¡ç›´æ¥æ¡¥æ¥åˆ°å®¿ä¸»æœºçš„ç‰©ç†ç½‘å¡ä¸Šï¼Œ
 ç›¸å½“äºâ€œæ¥å…¥åŒä¸€ä¸ªç‰©ç†äº¤æ¢æœºâ€ï¼Œè™šæ‹Ÿæœºä¸ä¸»æœºå¤„äºåŒä¸€å±€åŸŸç½‘ä¸­ã€‚

ğŸ“¡ **ç‰¹ç‚¹ï¼š**

| ä¼˜ç‚¹                                              | ç¼ºç‚¹                                    |
| ------------------------------------------------- | --------------------------------------- |
| è™šæ‹Ÿæœºæ‹¥æœ‰ä¸ä¸»æœºåŒç½‘æ®µçš„çœŸå® IPï¼Œå¯è¢«å¤–ç½‘ç›´æ¥è®¿é—® | éœ€è¦å±€åŸŸç½‘ DHCP æ”¯æŒï¼Œå¦åˆ™éœ€æ‰‹åŠ¨åˆ†é… IP |

ğŸ§  **é€‚ç”¨åœºæ™¯ï¼š**

- è™šæ‹Ÿæœºéœ€è¦åƒä¸€å°çœŸå®æœåŠ¡å™¨ä¸€æ ·è¢«è®¿é—®ï¼ˆå¦‚éƒ¨ç½² Webã€æ•°æ®åº“ç­‰ï¼‰ã€‚
- ç”¨äºä¼ä¸šå±€åŸŸç½‘ç¯å¢ƒã€‚

ğŸ”§ **ç¤ºæ„å›¾ï¼š**

```bash
[å¤–ç½‘]â”€â”€â”€[äº¤æ¢æœº]â”€â”€â”€[ä¸»æœºç‰©ç†ç½‘å¡]â”€â”€â”€[è™šæ‹Ÿæœºç½‘å¡(æ¡¥æ¥)]
```

------

### ğŸŒ â‘¡ NAT æ¨¡å¼ï¼ˆNetwork Address Translationï¼‰

ğŸ“˜ **åŸç†ï¼š**
 è™šæ‹Ÿæœºé€šè¿‡ä¸»æœºçš„ NAT åŠŸèƒ½å…±äº«ä¸»æœºå¤–ç½‘è¿æ¥ï¼Œ
 è™šæ‹Ÿæœºå¯ä»¥è®¿é—®å¤–ç½‘ï¼Œä½†å¤–éƒ¨ç½‘ç»œæ— æ³•ç›´æ¥è®¿é—®è™šæ‹Ÿæœºã€‚

ğŸ“¡ **ç‰¹ç‚¹ï¼š**

| ä¼˜ç‚¹                   | ç¼ºç‚¹                                     |
| ---------------------- | ---------------------------------------- |
| è™šæ‹Ÿæœºå¯ç›´æ¥è®¿é—®äº’è”ç½‘ | å¤–éƒ¨æ— æ³•ç›´æ¥è®¿é—®è™šæ‹Ÿæœºï¼ˆé™¤éåšç«¯å£æ˜ å°„ï¼‰ |

ğŸ§  **é€‚ç”¨åœºæ™¯ï¼š**

- è™šæ‹Ÿæœºåªéœ€ä¸Šç½‘æˆ–æ›´æ–°è½¯ä»¶ã€‚
- æµ‹è¯•æœåŠ¡å™¨ç¯å¢ƒï¼Œæ— éœ€å¤–éƒ¨è®¿é—®ã€‚

ğŸ”§ **ç«¯å£æ˜ å°„ç¤ºä¾‹ï¼ˆVMwareï¼‰ï¼š**

```bash
ä¸»æœº 8080 â†’ è™šæ‹Ÿæœº 80
```

è¿™æ ·è®¿é—®ä¸»æœºçš„ 8080 ç«¯å£å°±ç­‰äºè®¿é—®è™šæ‹Ÿæœºçš„ 80 ç«¯å£ã€‚

------

### ğŸ  â‘¢ ä¸»æœºæ¨¡å¼ï¼ˆHost-Onlyï¼‰

ğŸ“˜ **åŸç†ï¼š**
 ä»…å»ºç«‹ä¸»æœºä¸è™šæ‹Ÿæœºä¹‹é—´çš„ä¸“ç”¨ç½‘ç»œï¼Œè™šæ‹Ÿæœºä¸èƒ½ç›´æ¥è®¿é—®å¤–ç½‘ã€‚

ğŸ“¡ **ç‰¹ç‚¹ï¼š**

| ä¼˜ç‚¹               | ç¼ºç‚¹                                  |
| ------------------ | ------------------------------------- |
| ç½‘ç»œå°é—­ã€å®‰å…¨æ€§é«˜ | æ— æ³•è®¿é—®å¤–ç½‘ï¼Œéœ€è¦é¢å¤–è·¯ç”±æˆ– NAT è½¬å‘ |

ğŸ§  **é€‚ç”¨åœºæ™¯ï¼š**

- ä»…ä¸»æœºä¸è™šæ‹Ÿæœºä¹‹é—´é€šä¿¡ï¼ˆå¦‚æµ‹è¯•å±€åŸŸç½‘æœåŠ¡ï¼‰ã€‚
- å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜çš„å†…éƒ¨æµ‹è¯•ç¯å¢ƒã€‚

ğŸ”§ **ç¤ºæ„å›¾ï¼š**

```bash
[ä¸»æœº]â”€â”€â”€[è™šæ‹Ÿäº¤æ¢æœºï¼ˆHost-Onlyï¼‰]â”€â”€â”€[è™šæ‹Ÿæœº]
```

------

### ğŸ§® æ¨¡å¼å¯¹æ¯”æ±‡æ€»

| æ¨¡å¼            | æ˜¯å¦èƒ½ä¸Šç½‘ | æ˜¯å¦èƒ½è¢«è®¿é—®     | æ˜¯å¦ä¸ä¸»æœºäº’é€š | é€‚ç”¨åœºæ™¯             |
| --------------- | ---------- | ---------------- | -------------- | -------------------- |
| æ¡¥æ¥ï¼ˆBridgedï¼‰ | âœ… å¯ä»¥     | âœ… å¯ä»¥ï¼ˆåŒç½‘æ®µï¼‰ | âœ…              | æ­å»ºæœåŠ¡å™¨ã€æµ‹è¯•å…¬ç½‘ |
| NAT             | âœ… å¯ä»¥     | âŒ ä¸å¯ï¼ˆå¯æ˜ å°„ï¼‰ | âœ…              | ä¸Šç½‘ã€æ—¥å¸¸å¼€å‘       |
| Host-Only       | âŒ ä¸å¯     | âŒ ä¸å¯           | âœ…              | å†…ç½‘å®éªŒã€å®‰å…¨éš”ç¦»   |

------

### ğŸ§  å®æˆ˜å»ºè®®ï¼š

| éœ€æ±‚                             | æ¨èæ¨¡å¼         |
| -------------------------------- | ---------------- |
| éœ€è¦å…¬ç½‘è®¿é—®è™šæ‹Ÿæœº               | æ¡¥æ¥æ¨¡å¼         |
| è™šæ‹Ÿæœºä»…éœ€è®¿é—®å¤–ç½‘ï¼ˆå¦‚ yum/aptï¼‰ | NAT æ¨¡å¼         |
| ä»…ä¸ä¸»æœºäº¤äº’ã€ä¸è”ç½‘             | Host-Only æ¨¡å¼   |
| å¤šæœºè”é€šã€å¤–ç½‘ä¹Ÿå¯è®¿é—®           | æ··åˆï¼šæ¡¥æ¥ + NAT |

------

## âœ… ç« èŠ‚æ€»ç»“

| æ¨¡å—     | å·¥å…· / æ–‡ä»¶                           | åŠŸèƒ½             |
| -------- | ------------------------------------- | ---------------- |
| ç½‘ç»œæŸ¥çœ‹ | `ip addr`, `ifconfig`                 | æŸ¥çœ‹ç½‘å¡çŠ¶æ€     |
| ç½‘ç»œé…ç½® | `/etc/sysconfig/` / `/etc/netplan/`   | é…ç½®é™æ€ IP      |
| ç½‘ç»œè¯Šæ–­ | `ping`, `traceroute`, `ss`, `netstat` | è”é€šæ€§ä¸ç«¯å£æ£€æµ‹ |
| ç½‘ç»œæœåŠ¡ | `ssh`, `scp`, `dns`                   | è¿œç¨‹ç®¡ç†ä¸è§£æ   |
| é˜²ç«å¢™   | `firewall-cmd`, `ufw`                 | æ§åˆ¶ç«¯å£è®¿é—®     |
| æŠ“åŒ…åˆ†æ | `tcpdump`, `wireshark`                | ç½‘ç»œé€šä¿¡åˆ†æ     |
| æ€§èƒ½ä¼˜åŒ– | `sysctl`, `iperf3`                    | ç½‘ç»œè°ƒä¼˜         |
| ç½‘ç»œæ¨¡å¼ | æ¡¥æ¥ / NAT / Host-Only                | ç½‘ç»œè¿é€šç­–ç•¥     |

ğŸ’¡ **æœ€ç»ˆå£è¯€ï¼š**

> â€œæŸ¥æ¥å£ â†’ é…åœ°å€ â†’ é€šè·¯ç”± â†’ é˜²ç«å¢™ â†’ æŠ“æµé‡ â†’ ä¼˜æ€§èƒ½ â†’ é€‰æ¨¡å¼â€
>  â€”â€” Linux ç½‘ç»œç®¡ç†ä¸ƒæ­¥ç²¾åæ³• ğŸŒ

> 