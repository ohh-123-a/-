# 📁 004 文件管理

------

## 1️⃣ 📂 文件操作命令

文件与目录操作是 Linux 使用最频繁的部分。

```bash
touch file.txt         # 创建文件
mkdir dir              # 创建目录
cp a.txt b.txt         # 复制文件
mv file /tmp/          # 移动文件
rm file.txt            # 删除文件
rmdir emptydir         # 删除空目录
rm -r mydir            # 递归删除目录
```

🧩 **示例：**

```bash
ls -lh
```

📤 **输出：**

```bash
-rw-r--r-- 1 alice alice 1.2K Nov 8 09:20 file.txt
```

📘 **常用技巧：**

- `rm -i` 删除时确认。
- `cp -r` 递归复制目录。
- `mv` 也可用于**重命名文件**。

------

## 2️⃣ 🔍 文件查找

Linux 提供强大的查找工具：`find`、`locate` 和 `grep`。

```bash
find /home -name "*.txt"          # 在/home目录下查找所有.txt文件
locate test.log                   # 使用数据库快速查找文件
grep "root" /etc/passwd           # 在文件中查找匹配字符串
```

🧩 **示例：**

```bash
grep "bash" /etc/passwd
```

📤 **输出：**

```bash
root:x:0:0:root:/root:/bin/bash
```

📘 **技巧：**

- `grep -r`：递归搜索目录。
- `find / -type f -size +10M`：查找大于 10MB 的文件。
- `locate` 在使用前需运行 `updatedb` 更新数据库。

------

## 3️⃣ 🗜️ 文件压缩与解压

归档与压缩常用于备份和传输文件。

```bash
# 打包与压缩
tar -cvf archive.tar files/          # 打包文件
tar -czvf archive.tar.gz files/      # 打包并压缩为 .gz 格式

# 解压
tar -xvf archive.tar
tar -xzvf archive.tar.gz
```

📦 **常见压缩工具：**

| 工具  | 压缩命令             | 解压命令          |
| ----- | -------------------- | ----------------- |
| gzip  | gzip file            | gunzip file.gz    |
| bzip2 | bzip2 file           | bunzip2 file.bz2  |
| zip   | zip archive.zip file | unzip archive.zip |

🧩 **示例：**

```bash
tar -czvf backup.tar.gz /home/alice
```

📤 说明：将 `/home/alice` 打包并压缩为 `backup.tar.gz`。

------

## 4️⃣ ⚔️ 文本处理三剑客（grep、sed、awk）

Linux 中文本分析的三大神器，掌握它们可让你成为命令行高手。

------

### 🧩 grep —— 搜索利器

在文件中搜索匹配文本。

```bash
grep "root" /etc/passwd
grep -i "error" /var/log/syslog       # 忽略大小写
grep -r "main()" /home/user/code/     # 递归搜索
```

📘 **常用参数：**

| 参数 | 含义           |
| ---- | -------------- |
| `-n` | 显示行号       |
| `-v` | 显示不匹配的行 |
| `-r` | 递归搜索       |
| `-i` | 忽略大小写     |

------

### 🧩 sed —— 流编辑器

可进行文本替换、删除、插入，常用于自动化脚本。

```bash
sed 's/root/admin/g' /etc/passwd       # 替换root为admin（仅显示）
sed -i 's/http/https/g' index.html     # 直接修改文件内容
sed -n '1,5p' file.txt                 # 打印第1~5行
```

📘 **常见用法：**

| 命令          | 功能       |
| ------------- | ---------- |
| `s/old/new/g` | 全局替换   |
| `/pattern/d`  | 删除匹配行 |
| `/pattern/p`  | 打印匹配行 |

------

### 🧩 awk —— 文本分析神器

适合按列提取数据或统计结果。

```bash
awk '{print $1}' /etc/passwd             # 打印第一列
awk -F: '{print $1, $3}' /etc/passwd     # 指定分隔符为 :
awk '$3 > 1000 {print $1}' /etc/passwd   # 打印UID大于1000的用户
```

📘 **常见变量：**

| 符号         | 含义               |
| ------------ | ------------------ |
| `$1, $2 ...` | 每列内容           |
| `NF`         | 列数               |
| `NR`         | 当前行号           |
| `FS`         | 分隔符（默认空格） |

------

### 💡 实战组合示例

```
ps aux | grep nginx | awk '{print $2}' | xargs kill -9
```

📤 功能说明：
 查找并终止所有名为 **nginx** 的进程。

------

### ✅ 文本三剑客总结

| 工具   | 功能     | 适用场景           |
| ------ | -------- | ------------------ |
| `grep` | 搜索文本 | 查找日志、配置项   |
| `sed`  | 编辑文本 | 批量修改、替换内容 |
| `awk`  | 分析文本 | 提取字段、统计数据 |

------

## ✅ 本章总结

📘 **关键知识点回顾：**

- 学会使用 `cp`、`mv`、`rm`、`find`、`tar` 等命令完成文件管理。
- 理解文件与目录的权限、结构与常用操作。
- 掌握文本三剑客 `grep`、`sed`、`awk`，提升日志分析与批量处理效率。
- 组合命令管道 `|` 可以实现复杂任务自动化。

💡 **进阶建议：**

- 配合 `cron` 定时任务实现自动备份。
- 将 `awk` 与 `grep` 搭配，用于生成报表或统计分析。
- 熟悉正则表达式语法（`^`、`$`、`.`、`*`、`[]`）将让你如虎添翼。